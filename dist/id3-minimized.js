!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.ID3=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(require,module){function BinaryFile(strData,iDataOffset,iDataLength){var data=strData,dataOffset=iDataOffset||0,dataLength=0;this.getRawData=function(){return data},"string"==typeof strData?(dataLength=iDataLength||data.length,this.getByteAt=function(iOffset){return 255&data.charCodeAt(iOffset+dataOffset)}):"unknown"==typeof strData&&(dataLength=iDataLength||IEBinary_getLength(data),this.getByteAt=function(iOffset){return IEBinary_getByteAt(data,iOffset+dataOffset)}),this.getBytesAt=function(iOffset,iLength){for(var bytes=new Array(iLength),i=0;iLength>i;i++)bytes[i]=this.getByteAt(iOffset+i);return bytes},this.getLength=function(){return dataLength},this.isBitSetAt=function(iOffset,iBit){var iByte=this.getByteAt(iOffset);return 0!=(iByte&1<<iBit)},this.getSByteAt=function(iOffset){var iByte=this.getByteAt(iOffset);return iByte>127?iByte-256:iByte},this.getShortAt=function(iOffset,bBigEndian){var iShort=bBigEndian?(this.getByteAt(iOffset)<<8)+this.getByteAt(iOffset+1):(this.getByteAt(iOffset+1)<<8)+this.getByteAt(iOffset);return 0>iShort&&(iShort+=65536),iShort},this.getSShortAt=function(iOffset,bBigEndian){var iUShort=this.getShortAt(iOffset,bBigEndian);return iUShort>32767?iUShort-65536:iUShort},this.getLongAt=function(iOffset,bBigEndian){var iByte1=this.getByteAt(iOffset),iByte2=this.getByteAt(iOffset+1),iByte3=this.getByteAt(iOffset+2),iByte4=this.getByteAt(iOffset+3),iLong=bBigEndian?(((iByte1<<8)+iByte2<<8)+iByte3<<8)+iByte4:(((iByte4<<8)+iByte3<<8)+iByte2<<8)+iByte1;return 0>iLong&&(iLong+=4294967296),iLong},this.getSLongAt=function(iOffset,bBigEndian){var iULong=this.getLongAt(iOffset,bBigEndian);return iULong>2147483647?iULong-4294967296:iULong},this.getInteger24At=function(iOffset,bBigEndian){var iByte1=this.getByteAt(iOffset),iByte2=this.getByteAt(iOffset+1),iByte3=this.getByteAt(iOffset+2),iInteger=bBigEndian?((iByte1<<8)+iByte2<<8)+iByte3:((iByte3<<8)+iByte2<<8)+iByte1;return 0>iInteger&&(iInteger+=16777216),iInteger},this.getStringAt=function(iOffset,iLength){for(var aStr=[],i=iOffset,j=0;iOffset+iLength>i;i++,j++)aStr[j]=String.fromCharCode(this.getByteAt(i));return aStr.join("")},this.getStringWithCharsetAt=function(iOffset,iLength,iCharset){var sString,bytes=this.getBytesAt(iOffset,iLength);switch(iCharset.toLowerCase()){case"utf-16":case"utf-16le":case"utf-16be":sString=StringUtils.readUTF16String(bytes,iCharset);break;case"utf-8":sString=StringUtils.readUTF8String(bytes);break;default:sString=StringUtils.readNullTerminatedString(bytes)}return sString},this.getCharAt=function(iOffset){return String.fromCharCode(this.getByteAt(iOffset))},this.toBase64=function(){return b64utils.btoa(data)},this.fromBase64=function(strBase64){data=b64utils.atob(strBase64)},this.loadRange=function(range,callback){callback()}}var StringUtils=require("./stringutils"),b64utils={};if("undefined"!=typeof document){var js=document.createElement("script");js.type="text/vbscript",js.textContent="Function IEBinary_getByteAt(strBinary, iOffset)\r\n	IEBinary_getByteAt = AscB(MidB(strBinary,iOffset+1,1))\r\nEnd Function\r\nFunction IEBinary_getLength(strBinary)\r\n	IEBinary_getLength = LenB(strBinary)\r\nEnd Function\r\n",document.getElementsByTagName("head")[0].appendChild(js),b64utils.btoa=window.btoa,b64utils.atob=window.atob}else b64utils.btoa=require("btoa"),b64utils.atob=require("atob");module.exports=BinaryFile},{"./stringutils":9,atob:void 0,btoa:void 0}],2:[function(require,module){var BinaryFile=require("./binaryfile"),BufferedBinaryAjax=function(strUrl,fncCallback,fncError){function sendRequest(strURL,fncCallback,fncError,aRange,bAcceptRanges,iFileSize,bAsync){var oHTTP=createRequest();if(oHTTP){var iDataOffset=0;aRange&&!bAcceptRanges&&(iDataOffset=aRange[0]);var iDataLen=0;aRange&&(iDataLen=aRange[1]-aRange[0]+1),"undefined"==typeof bAsync&&(bAsync=!0),fncCallback&&("undefined"!=typeof oHTTP.onload?(oHTTP.onload=function(){"200"==oHTTP.status||"206"==oHTTP.status?(oHTTP.fileSize=iFileSize||oHTTP.getResponseHeader("Content-Length"),fncCallback(oHTTP)):fncError&&fncError({error:"xhr",xhr:oHTTP}),oHTTP=null},fncError&&(oHTTP.onerror=function(){fncError({error:"xhr",xhr:oHTTP}),oHTTP=null})):oHTTP.onreadystatechange=function(){4==oHTTP.readyState&&("200"==oHTTP.status||"206"==oHTTP.status?(oHTTP.fileSize=iFileSize||oHTTP.getResponseHeader("Content-Length"),fncCallback(oHTTP)):fncError&&fncError({error:"xhr",xhr:oHTTP}),oHTTP=null)}),oHTTP.open("GET",strURL,bAsync),oHTTP.overrideMimeType&&oHTTP.overrideMimeType("text/plain; charset=x-user-defined"),aRange&&bAcceptRanges&&oHTTP.setRequestHeader("Range","bytes="+aRange[0]+"-"+aRange[1]),oHTTP.setRequestHeader("If-Modified-Since","Sat, 01 Jan 1970 00:00:00 GMT"),oHTTP.send(null)}else fncError&&fncError({error:"Unable to create XHR object"})}function createRequest(){var oHTTP=null;if("undefined"==typeof window){var XMLHttpRequest=require("xmlhttprequest").XMLHttpRequest;oHTTP=new XMLHttpRequest}else window.XMLHttpRequest?oHTTP=new window.XMLHttpRequest:window.ActiveXObject&&(oHTTP=new window.ActiveXObject("Microsoft.XMLHTTP"));return oHTTP}function getHead(strURL,fncCallback,fncError){var oHTTP=createRequest();oHTTP?(fncCallback&&("undefined"!=typeof oHTTP.onload?(oHTTP.onload=function(){"200"==oHTTP.status||"206"==oHTTP.status?fncCallback(this):fncError&&fncError({error:"xhr",xhr:oHTTP}),oHTTP=null},fncError&&(oHTTP.onerror=function(){fncError({error:"xhr",xhr:oHTTP}),oHTTP=null})):oHTTP.onreadystatechange=function(){4==oHTTP.readyState&&("200"==oHTTP.status||"206"==oHTTP.status?fncCallback(this):fncError&&fncError({error:"xhr",xhr:oHTTP}),oHTTP=null)}),oHTTP.open("HEAD",strURL,!0),oHTTP.send(null)):fncError&&fncError({error:"Unable to create XHR object"})}function BufferedBinaryFile(strUrl,iLength,blockSize,blockRadius){function getBlockRangeForByteRange(range){var blockStart=~~(range[0]/blockSize)-blockRadius,blockEnd=~~(range[1]/blockSize)+1+blockRadius;return 0>blockStart&&(blockStart=0),blockEnd>=blockTotal&&(blockEnd=blockTotal-1),[blockStart,blockEnd]}function getBlockAtOffset(offset){var blockRange=getBlockRangeForByteRange([offset,offset]);return waitForBlocks(blockRange),blocks[~~(offset/blockSize)]}function waitForBlocks(blockRange,callback){for(;blocks[blockRange[0]];)if(blockRange[0]++,blockRange[0]>blockRange[1])return callback?callback():undefined;for(;blocks[blockRange[1]];)if(blockRange[1]--,blockRange[0]>blockRange[1])return callback?callback():undefined;var range=[blockRange[0]*blockSize,(blockRange[1]+1)*blockSize-1];sendRequest(strUrl,function(http){var size=parseInt(http.getResponseHeader("Content-Length"),10);size==iLength&&(blockRange[0]=0,blockRange[1]=blockTotal-1,range[0]=0,range[1]=iLength-1);for(var block={data:http.responseBody||http.responseText,offset:range[0]},i=blockRange[0];i<=blockRange[1];i++)blocks[i]=block;downloadedBytesCount+=range[1]-range[0]+1,callback&&callback()},fncError,range,"bytes",undefined,!!callback)}var undefined,downloadedBytesCount=0,binaryFile=new BinaryFile("",0,iLength),blocks=[];blockSize=blockSize||2048,blockRadius="undefined"==typeof blockRadius?0:blockRadius,blockTotal=~~((iLength-1)/blockSize)+1;for(var key in binaryFile)binaryFile.hasOwnProperty(key)&&"function"==typeof binaryFile[key]&&(this[key]=binaryFile[key]);this.getByteAt=function(iOffset){var block=getBlockAtOffset(iOffset);return block&&"string"==typeof block.data?255&block.data.charCodeAt(iOffset-block.offset):block&&"unknown"==typeof block.data?IEBinary_getByteAt(block.data,iOffset-block.offset):""},this.getDownloadedBytesCount=function(){return downloadedBytesCount},this.loadRange=function(range,callback){var blockRange=getBlockRangeForByteRange(range);waitForBlocks(blockRange,callback)}}function init(){getHead(strUrl,function(oHTTP){var iLength=parseInt(oHTTP.getResponseHeader("Content-Length"),10)||-1;fncCallback(new BufferedBinaryFile(strUrl,iLength))},fncError)}init()};module.exports=BufferedBinaryAjax},{"./binaryfile":1,xmlhttprequest:void 0}],3:[function(require,module){var BinaryFile=require("./binaryfile"),FileAPIReader=function(file,opt_reader){return function(url,fncCallback){var reader=opt_reader||new FileReader;reader.onload=function(event){var result=event.target.result;fncCallback(new BinaryFile(result))},reader.readAsBinaryString(file)}};module.exports=FileAPIReader},{"./binaryfile":1}],4:[function(require,module){function getTagReader(data){return"ftypM4A"==data.getStringAt(4,7)?ID4:"ID3"==data.getStringAt(0,3)?ID3v2:ID3v1}function readTags(reader,data,url,tags){var tagsFound=reader.readTagsFromData(data,tags),tags=_files[url]||{};for(var tag in tagsFound)tagsFound.hasOwnProperty(tag)&&(tags[tag]=tagsFound[tag]);_files[url]=tags}var ID4=require("./id4"),ID3v1=require("./id3v1"),ID3v2=require("./id3v2"),BufferedBinaryAjax=require("./bufferedbinaryajax"),FileAPIReader=require("./filereader"),ID3={FileAPIReader:FileAPIReader},_files={},_formatIDRange=[0,7];ID3.clearTags=function(url){delete _files[url]},ID3.clearAll=function(){_files={}},ID3.loadTags=function(url,cb,options){options=options||{};var dataReader=options.dataReader||BufferedBinaryAjax;dataReader(url,function(data){data.loadRange(_formatIDRange,function(){var reader=getTagReader(data);reader.loadData(data,function(){readTags(reader,data,url,options.tags),cb&&cb()})})},options.onError)},ID3.getAllTags=function(url){if(!_files[url])return null;var tags={};for(var a in _files[url])_files[url].hasOwnProperty(a)&&(tags[a]=_files[url][a]);return tags},ID3.getTag=function(url,tag){return _files[url]?_files[url][tag]:null},module.exports=ID3},{"./bufferedbinaryajax":2,"./filereader":3,"./id3v1":5,"./id3v2":6,"./id4":8}],5:[function(require,module){var ID3v1={},genres=["Blues","Classic Rock","Country","Dance","Disco","Funk","Grunge","Hip-Hop","Jazz","Metal","New Age","Oldies","Other","Pop","R&B","Rap","Reggae","Rock","Techno","Industrial","Alternative","Ska","Death Metal","Pranks","Soundtrack","Euro-Techno","Ambient","Trip-Hop","Vocal","Jazz+Funk","Fusion","Trance","Classical","Instrumental","Acid","House","Game","Sound Clip","Gospel","Noise","AlternRock","Bass","Soul","Punk","Space","Meditative","Instrumental Pop","Instrumental Rock","Ethnic","Gothic","Darkwave","Techno-Industrial","Electronic","Pop-Folk","Eurodance","Dream","Southern Rock","Comedy","Cult","Gangsta","Top 40","Christian Rap","Pop/Funk","Jungle","Native American","Cabaret","New Wave","Psychadelic","Rave","Showtunes","Trailer","Lo-Fi","Tribal","Acid Punk","Acid Jazz","Polka","Retro","Musical","Rock & Roll","Hard Rock","Folk","Folk-Rock","National Folk","Swing","Fast Fusion","Bebob","Latin","Revival","Celtic","Bluegrass","Avantgarde","Gothic Rock","Progressive Rock","Psychedelic Rock","Symphonic Rock","Slow Rock","Big Band","Chorus","Easy Listening","Acoustic","Humour","Speech","Chanson","Opera","Chamber Music","Sonata","Symphony","Booty Bass","Primus","Porn Groove","Satire","Slow Jam","Club","Tango","Samba","Folklore","Ballad","Power Ballad","Rhythmic Soul","Freestyle","Duet","Punk Rock","Drum Solo","Acapella","Euro-House","Dance Hall"];ID3v1.loadData=function(data,callback){var length=data.getLength();data.loadRange([length-128-1,length],callback)},ID3v1.readTagsFromData=function(data){var offset=data.getLength()-128,header=data.getStringAt(offset,3);if("TAG"==header){var title=data.getStringAt(offset+3,30).replace(/\0/g,""),artist=data.getStringAt(offset+33,30).replace(/\0/g,""),album=data.getStringAt(offset+63,30).replace(/\0/g,""),year=data.getStringAt(offset+93,4).replace(/\0/g,""),trackFlag=data.getByteAt(offset+97+28);if(0==trackFlag)var comment=data.getStringAt(offset+97,28).replace(/\0/g,""),track=data.getByteAt(offset+97+29);else var comment="",track=0;var genreIdx=data.getByteAt(offset+97+30);if(255>genreIdx)var genre=genres[genreIdx];else var genre="";return{version:"1.1",title:title,artist:artist,album:album,year:year,comment:comment,track:track,genre:genre}}return{}},module.exports=ID3v1},{}],6:[function(require,module){function getTagsFromShortcuts(shortcuts){for(var shortcut,tags=[],i=0;shortcut=shortcuts[i];i++)tags=tags.concat(_shortcuts[shortcut]||[shortcut]);return tags}function readSynchsafeInteger32At(offset,data){var size1=data.getByteAt(offset),size2=data.getByteAt(offset+1),size3=data.getByteAt(offset+2),size4=data.getByteAt(offset+3),size=127&size4|(127&size3)<<7|(127&size2)<<14|(127&size1)<<21;return size}function readFrameFlags(data,offset){var flags={message:{tag_alter_preservation:data.isBitSetAt(offset,6),file_alter_preservation:data.isBitSetAt(offset,5),read_only:data.isBitSetAt(offset,4)},format:{grouping_identity:data.isBitSetAt(offset+1,7),compression:data.isBitSetAt(offset+1,3),encription:data.isBitSetAt(offset+1,2),unsynchronisation:data.isBitSetAt(offset+1,1),data_length_indicator:data.isBitSetAt(offset+1,0)}};return flags}function readFrames(offset,end,data,id3header,tags){var frameDataSize,frames={},major=id3header.major;for(tags=getTagsFromShortcuts(tags||_defaultShortcuts);end>offset;){var readFrameFunc=null,frameData=data,frameDataOffset=offset,flags=null;switch(major){case 2:var frameID=frameData.getStringAt(frameDataOffset,3),frameSize=frameData.getInteger24At(frameDataOffset+3,!0),frameHeaderSize=6;break;case 3:var frameID=frameData.getStringAt(frameDataOffset,4),frameSize=frameData.getLongAt(frameDataOffset+4,!0),frameHeaderSize=10;break;case 4:var frameID=frameData.getStringAt(frameDataOffset,4),frameSize=readSynchsafeInteger32At(frameDataOffset+4,frameData),frameHeaderSize=10}if(""==frameID)break;if(offset+=frameHeaderSize+frameSize,!(tags.indexOf(frameID)<0||(major>2&&(flags=readFrameFlags(frameData,frameDataOffset+8)),frameDataOffset+=frameHeaderSize,flags&&flags.format.data_length_indicator&&(frameDataSize=readSynchsafeInteger32At(frameDataOffset,frameData),frameDataOffset+=4,frameSize-=4),flags&&flags.format.unsynchronisation))){frameID in ID3v2.readFrameData?readFrameFunc=ID3v2.readFrameData[frameID]:"T"==frameID[0]&&(readFrameFunc=ID3v2.readFrameData["T*"]);var parsedData=readFrameFunc?readFrameFunc(frameDataOffset,frameSize,frameData,flags):void 0,desc=frameID in ID3v2.frames?ID3v2.frames[frameID]:"Unknown",frame={id:frameID,size:frameSize,description:desc,data:parsedData};frameID in frames?(frames[frameID].id&&(frames[frameID]=[frames[frameID]]),frames[frameID].push(frame)):frames[frameID]=frame}}return frames}function getFrameData(frames,ids){"string"==typeof ids&&(ids=[ids]);for(var id,i=0;id=ids[i];i++)if(id in frames)return frames[id].data}var ID3v2=require("./id3v2frames");ID3v2.frames={BUF:"Recommended buffer size",CNT:"Play counter",COM:"Comments",CRA:"Audio encryption",CRM:"Encrypted meta frame",ETC:"Event timing codes",EQU:"Equalization",GEO:"General encapsulated object",IPL:"Involved people list",LNK:"Linked information",MCI:"Music CD Identifier",MLL:"MPEG location lookup table",PIC:"Attached picture",POP:"Popularimeter",REV:"Reverb",RVA:"Relative volume adjustment",SLT:"Synchronized lyric/text",STC:"Synced tempo codes",TAL:"Album/Movie/Show title",TBP:"BPM (Beats Per Minute)",TCM:"Composer",TCO:"Content type",TCR:"Copyright message",TDA:"Date",TDY:"Playlist delay",TEN:"Encoded by",TFT:"File type",TIM:"Time",TKE:"Initial key",TLA:"Language(s)",TLE:"Length",TMT:"Media type",TOA:"Original artist(s)/performer(s)",TOF:"Original filename",TOL:"Original Lyricist(s)/text writer(s)",TOR:"Original release year",TOT:"Original album/Movie/Show title",TP1:"Lead artist(s)/Lead performer(s)/Soloist(s)/Performing group",TP2:"Band/Orchestra/Accompaniment",TP3:"Conductor/Performer refinement",TP4:"Interpreted, remixed, or otherwise modified by",TPA:"Part of a set",TPB:"Publisher",TRC:"ISRC (International Standard Recording Code)",TRD:"Recording dates",TRK:"Track number/Position in set",TSI:"Size",TSS:"Software/hardware and settings used for encoding",TT1:"Content group description",TT2:"Title/Songname/Content description",TT3:"Subtitle/Description refinement",TXT:"Lyricist/text writer",TXX:"User defined text information frame",TYE:"Year",UFI:"Unique file identifier",ULT:"Unsychronized lyric/text transcription",WAF:"Official audio file webpage",WAR:"Official artist/performer webpage",WAS:"Official audio source webpage",WCM:"Commercial information",WCP:"Copyright/Legal information",WPB:"Publishers official webpage",WXX:"User defined URL link frame",AENC:"Audio encryption",APIC:"Attached picture",COMM:"Comments",COMR:"Commercial frame",ENCR:"Encryption method registration",EQUA:"Equalization",ETCO:"Event timing codes",GEOB:"General encapsulated object",GRID:"Group identification registration",IPLS:"Involved people list",LINK:"Linked information",MCDI:"Music CD identifier",MLLT:"MPEG location lookup table",OWNE:"Ownership frame",PRIV:"Private frame",PCNT:"Play counter",POPM:"Popularimeter",POSS:"Position synchronisation frame",RBUF:"Recommended buffer size",RVAD:"Relative volume adjustment",RVRB:"Reverb",SYLT:"Synchronized lyric/text",SYTC:"Synchronized tempo codes",TALB:"Album/Movie/Show title",TBPM:"BPM (beats per minute)",TCOM:"Composer",TCON:"Content type",TCOP:"Copyright message",TDAT:"Date",TDLY:"Playlist delay",TENC:"Encoded by",TEXT:"Lyricist/Text writer",TFLT:"File type",TIME:"Time",TIT1:"Content group description",TIT2:"Title/songname/content description",TIT3:"Subtitle/Description refinement",TKEY:"Initial key",TLAN:"Language(s)",TLEN:"Length",TMED:"Media type",TOAL:"Original album/movie/show title",TOFN:"Original filename",TOLY:"Original lyricist(s)/text writer(s)",TOPE:"Original artist(s)/performer(s)",TORY:"Original release year",TOWN:"File owner/licensee",TPE1:"Lead performer(s)/Soloist(s)",TPE2:"Band/orchestra/accompaniment",TPE3:"Conductor/performer refinement",TPE4:"Interpreted, remixed, or otherwise modified by",TPOS:"Part of a set",TPUB:"Publisher",TRCK:"Track number/Position in set",TRDA:"Recording dates",TRSN:"Internet radio station name",TRSO:"Internet radio station owner",TSIZ:"Size",TSRC:"ISRC (international standard recording code)",TSSE:"Software/Hardware and settings used for encoding",TYER:"Year",TXXX:"User defined text information frame",UFID:"Unique file identifier",USER:"Terms of use",USLT:"Unsychronized lyric/text transcription",WCOM:"Commercial information",WCOP:"Copyright/Legal information",WOAF:"Official audio file webpage",WOAR:"Official artist/performer webpage",WOAS:"Official audio source webpage",WORS:"Official internet radio station homepage",WPAY:"Payment",WPUB:"Publishers official webpage",WXXX:"User defined URL link frame"};var _shortcuts={title:["TIT2","TT2"],artist:["TPE1","TP1"],album:["TALB","TAL"],year:["TYER","TYE"],comment:["COMM","COM"],track:["TRCK","TRK"],genre:["TCON","TCO"],picture:["APIC","PIC"],lyrics:["USLT","ULT"]},_defaultShortcuts=["title","artist","album","track"];ID3v2.loadData=function(data,callback){data.loadRange([0,readSynchsafeInteger32At(6,data)],callback)},ID3v2.readTagsFromData=function(data,tags){var offset=0,major=data.getByteAt(offset+3);if(major>4)return{version:">2.4"};var revision=data.getByteAt(offset+4),unsynch=data.isBitSetAt(offset+5,7),xheader=data.isBitSetAt(offset+5,6),xindicator=data.isBitSetAt(offset+5,5),size=readSynchsafeInteger32At(offset+6,data);if(offset+=10,xheader){var xheadersize=data.getLongAt(offset,!0);offset+=xheadersize+4}var id3={version:"2."+major+"."+revision,major:major,revision:revision,flags:{unsynchronisation:unsynch,extended_header:xheader,experimental_indicator:xindicator},size:size},frames=unsynch?{}:readFrames(offset,size-10,data,id3,tags);for(var name in _shortcuts)if(_shortcuts.hasOwnProperty(name)){var data=getFrameData(frames,_shortcuts[name]);data&&(id3[name]=data)}for(var frame in frames)frames.hasOwnProperty(frame)&&(id3[frame]=frames[frame]);return id3},module.exports=ID3v2},{"./id3v2frames":7}],7:[function(require,module){function getTextEncoding(bite){var charset;switch(bite){case 0:charset="iso-8859-1";break;case 1:charset="utf-16";break;case 2:charset="utf-16be";break;case 3:charset="utf-8"}return charset}var ID3v2={readFrameData:{}},pictureType=["32x32 pixels 'file icon' (PNG only)","Other file icon","Cover (front)","Cover (back)","Leaflet page","Media (e.g. lable side of CD)","Lead artist/lead performer/soloist","Artist/performer","Conductor","Band/Orchestra","Composer","Lyricist/text writer","Recording Location","During recording","During performance","Movie/video screen capture","A bright coloured fish","Illustration","Band/artist logotype","Publisher/Studio logotype"];ID3v2.readFrameData.APIC=function(offset,length,data,flags,v){v=v||"3";var start=offset,charset=getTextEncoding(data.getByteAt(offset));switch(v){case"2":var format=data.getStringAt(offset+1,3);offset+=4;break;case"3":case"4":var format=data.getStringWithCharsetAt(offset+1,length-(offset-start),"");offset+=1+format.bytesReadCount}var bite=data.getByteAt(offset,1),type=pictureType[bite],desc=data.getStringWithCharsetAt(offset+1,length-(offset-start),charset);return offset+=1+desc.bytesReadCount,{format:format.toString(),type:type,description:desc.toString(),data:data.getBytesAt(offset,start+length-offset)}},ID3v2.readFrameData.COMM=function(offset,length,data){var start=offset,charset=getTextEncoding(data.getByteAt(offset)),language=data.getStringAt(offset+1,3),shortdesc=data.getStringWithCharsetAt(offset+4,length-4,charset);offset+=4+shortdesc.bytesReadCount;var text=data.getStringWithCharsetAt(offset,start+length-offset,charset);return{language:language,short_description:shortdesc.toString(),text:text.toString()}},ID3v2.readFrameData.COM=ID3v2.readFrameData.COMM,ID3v2.readFrameData.PIC=function(offset,length,data,flags){return ID3v2.readFrameData.APIC(offset,length,data,flags,"2")},ID3v2.readFrameData.PCNT=function(offset,length,data){return data.getInteger32At(offset)},ID3v2.readFrameData.CNT=ID3v2.readFrameData.PCNT,ID3v2.readFrameData["T*"]=function(offset,length,data){var charset=getTextEncoding(data.getByteAt(offset));return data.getStringWithCharsetAt(offset+1,length-1,charset).toString()},ID3v2.readFrameData.TCON=function(){var text=ID3v2.readFrameData["T*"].apply(this,arguments);return text.replace(/^\(\d+\)/,"")},ID3v2.readFrameData.TCO=ID3v2.readFrameData.TCON,ID3v2.readFrameData.USLT=function(offset,length,data){var start=offset,charset=getTextEncoding(data.getByteAt(offset)),language=data.getStringAt(offset+1,3),descriptor=data.getStringWithCharsetAt(offset+4,length-4,charset);offset+=4+descriptor.bytesReadCount;var lyrics=data.getStringWithCharsetAt(offset,start+length-offset,charset);return{language:language,descriptor:descriptor.toString(),lyrics:lyrics.toString()}},ID3v2.readFrameData.ULT=ID3v2.readFrameData.USLT,module.exports=ID3v2},{}],8:[function(require,module){function loadAtom(data,offset,length,callback){var atomSize=data.getLongAt(offset,!0);if(0==atomSize)return callback();var atomName=data.getStringAt(offset+4,4);if(["moov","udta","meta","ilst"].indexOf(atomName)>-1)"meta"==atomName&&(offset+=4),data.loadRange([offset+8,offset+8+8],function(){loadAtom(data,offset+8,atomSize-8,callback)});else{var readAtom=atomName in ID4.atom;data.loadRange([offset+(readAtom?0:atomSize),offset+atomSize+8],function(){loadAtom(data,offset+atomSize,length,callback)})}}function readAtom(tag,data,offset,length,indent){indent=void 0===indent?"":indent+"  ";for(var seek=offset;offset+length>seek;){var atomSize=data.getLongAt(seek,!0);if(0==atomSize)return;var atomName=data.getStringAt(seek+4,4);if(["moov","udta","meta","ilst"].indexOf(atomName)>-1)return"meta"==atomName&&(seek+=4),void readAtom(tag,data,seek+8,atomSize-8,indent);if(ID4.atom[atomName]){var klass=data.getInteger24At(seek+16+1,!0),atom=ID4.atom[atomName],type=ID4.types[klass];if("trkn"==atomName)tag[atom[0]]=data.getByteAt(seek+16+11),tag.count=data.getByteAt(seek+16+13);else{var atomData,dataStart=seek+16+4+4,dataEnd=atomSize-16-4-4;switch(type){case"text":atomData=data.getStringWithCharsetAt(dataStart,dataEnd,"UTF-8");break;case"uint8":atomData=data.getShortAt(dataStart);break;case"jpeg":case"png":atomData={format:"image/"+type,data:data.getBytesAt(dataStart,dataEnd)}}tag[atom[0]]="comment"===atom[0]?{text:atomData}:atomData}}seek+=atomSize}}var ID4={};ID4.types={0:"uint8",1:"text",13:"jpeg",14:"png",21:"uint8"},ID4.atom={"©alb":["album"],"©art":["artist"],"©ART":["artist"],aART:["artist"],"©day":["year"],"©nam":["title"],"©gen":["genre"],trkn:["track"],"©wrt":["composer"],"©too":["encoder"],cprt:["copyright"],covr:["picture"],"©grp":["grouping"],keyw:["keyword"],"©lyr":["lyrics"],"©cmt":["comment"],tmpo:["tempo"],cpil:["compilation"],disk:["disc"]},ID4.loadData=function(data,callback){data.loadRange([0,7],function(){loadAtom(data,0,data.getLength(),callback)})},ID4.readTagsFromData=function(data){var tag={};return readAtom(tag,data,0,data.getLength()),tag},module.exports=ID4},{}],9:[function(require,module){var StringUtils={readUTF16String:function(bytes,bigEndian,maxBytes){var ix=0,offset1=1,offset2=0;maxBytes=Math.min(maxBytes||bytes.length,bytes.length),254==bytes[0]&&255==bytes[1]?(bigEndian=!0,ix=2):255==bytes[0]&&254==bytes[1]&&(bigEndian=!1,ix=2),bigEndian&&(offset1=0,offset2=1);for(var arr=[],j=0;maxBytes>ix;j++){var byte1=bytes[ix+offset1],byte2=bytes[ix+offset2],word1=(byte1<<8)+byte2;if(ix+=2,0==word1)break;if(216>byte1||byte1>=224)arr[j]=String.fromCharCode(word1);else{var byte3=bytes[ix+offset1],byte4=bytes[ix+offset2],word2=(byte3<<8)+byte4;ix+=2,arr[j]=String.fromCharCode(word1,word2)}}var string=new String(arr.join(""));return string.bytesReadCount=ix,string},readUTF8String:function(bytes,maxBytes){var ix=0;maxBytes=Math.min(maxBytes||bytes.length,bytes.length),239==bytes[0]&&187==bytes[1]&&191==bytes[2]&&(ix=3);for(var arr=[],j=0;maxBytes>ix;j++){var byte1=bytes[ix++];if(0==byte1)break;if(128>byte1)arr[j]=String.fromCharCode(byte1);else if(byte1>=194&&224>byte1){var byte2=bytes[ix++];arr[j]=String.fromCharCode(((31&byte1)<<6)+(63&byte2))}else if(byte1>=224&&240>byte1){var byte2=bytes[ix++],byte3=bytes[ix++];arr[j]=String.fromCharCode(((255&byte1)<<12)+((63&byte2)<<6)+(63&byte3))}else if(byte1>=240&&245>byte1){var byte2=bytes[ix++],byte3=bytes[ix++],byte4=bytes[ix++],codepoint=((7&byte1)<<18)+((63&byte2)<<12)+((63&byte3)<<6)+(63&byte4)-65536;arr[j]=String.fromCharCode((codepoint>>10)+55296,(1023&codepoint)+56320)}}var string=new String(arr.join(""));return string.bytesReadCount=ix,string},readNullTerminatedString:function(bytes,maxBytes){var arr=[];maxBytes=maxBytes||bytes.length;for(var i=0;maxBytes>i;){var byte1=bytes[i++];if(0==byte1)break;arr[i-1]=String.fromCharCode(byte1)}var string=new String(arr.join(""));return string.bytesReadCount=i,string}};module.exports=StringUtils},{}]},{},[4])(4)});